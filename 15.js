(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[15],{"/7QA":function(t,i,s){"use strict";s.r(i);var e,a,r=s("vrbx"),o=s.n(r),n=s("iojd"),h=s("8jQa"),l=s.n(h);(function(t){t["in"]="in",t["out"]="out"})(e||(e={})),function(t){t["circle"]="circle",t["arrow"]="arrow",t["img"]="img"}(a||(a={}));var d=1.5,c=3,p={marker:{radius:[5,10],pulse:!0,textVisible:!0},line:{width:1,order:!0,icon:{type:a.arrow,imgUrl:"",size:20},direction:e.out}},v=12;function u(t,i){var s=t=>t*t;return Math.sqrt(s(t)+s(i))}function g(t,i){var s,e;return t.forEach((t=>{var a=i(t);void 0===s?(e=a,s=a):(s>a&&(s=a),e<a&&(e=a))})),[s,e]}function m(t){return Object.prototype.toString.call(t).slice(8,-1)}class x{constructor(t){this.startX=void 0,this.startY=void 0,this.endX=void 0,this.endY=void 0,this.centerX=void 0,this.centerY=void 0,this.startAngle=void 0,this.endAngle=void 0,this.radius=void 0,this.color=void 0,this.lineWidth=1;var i=t.startX,s=t.startY,e=t.endX,a=t.endY,r=t.width,o=t.color,n=void 0===o?"#fff":o,h=u(i-e,s-a),l=(i+e)/2,c=(s+a)/2,p=(s-a)*d+l,v=(e-i)*d+c,g=u(h/2,h*d),m=Math.atan2(s-v,i-p),x=Math.atan2(a-v,e-p);this.startX=i,this.startY=s,this.endX=e,this.endY=a,this.centerX=p,this.centerY=v,this.startAngle=m,this.endAngle=x,this.radius=g,this.color=n,this.lineWidth=r||1}draw(t){}}var w=x;class f extends w{constructor(t){super(t),this.font=void 0,this.label=void 0,this.labels=void 0,this.font=t.font,this.label=t.label,this.labels=t.labels}draw(t){if(Object.assign(t,{lineWidth:this.lineWidth,strokeStyle:this.color}),t.beginPath(),t.arc(this.centerX,this.centerY,this.radius,this.startAngle,this.endAngle,!1),t.stroke(),this.label){var i=Object(n["default"])(this.labels,2),s=i[0],e=i[1];if(Object.assign(t,{font:this.font}),s){var a=this.startX-15,r=this.startY+5;t.fillText(s,a,r)}if(e){var o=this.endX-15,h=this.endY-5;t.fillText(e,o,h)}}}}var b=f,y=[];class A{constructor(t){this.options=void 0,this.scale=1,this.pulse=void 0,this.ring=void 0,this.showPopover=t=>{var i=t.clientX,s=t.clientY,e=this.options,a=e.data,r=e.index,o=e.popover,n=e.ctx,h=n.mapPosi,l=h.top,d=h.left;o.show(i-d,s-l,a,r)},this.hidePopover=()=>{var t=this.options,i=t.data,s=t.index,e=t.popover;e.hide(i,s)},this.options=t,this.initDom()}clear(){var t=this.pulse;y.push(t),t.removeEventListener("mouseover",this.showPopover),t.removeEventListener("mouseout",this.hidePopover),this.options.ctx.container.removeChild(t)}initDom(){y.length>0?(this.pulse=y.pop(),this.ring=this.pulse.children[0]):(this.pulse=document.createElement("div"),this.ring=document.createElement("div"),this.pulse.appendChild(this.ring));var t=this.options,i=t.x,s=t.y,e=t.radius,a=t.data.color,r=this.pulse,o=this.ring;Object.assign(r.style,{position:"absolute",zIndex:"1",borderRadius:"50%",width:"".concat(2*e,"px"),height:"".concat(2*e,"px"),left:"-".concat(e,"px"),top:"-".concat(e,"px"),background:a,transform:"translate(".concat(i,"px, ").concat(s,"px)")}),Object.assign(o.style,{position:"absolute",borderRadius:"50%",width:"".concat(2*e,"px"),height:"".concat(2*e,"px"),left:"".concat(-1,"px"),top:"".concat(-1,"px"),border:"1px solid ".concat(a)}),this.options.ctx.container.appendChild(r),r.addEventListener("mouseover",this.showPopover),r.addEventListener("mouseout",this.hidePopover)}draw(){var t=this.scale;Object.assign(this.ring.style,{transform:"scale(".concat(t,")")}),this.scale+=.02,t>2&&(this.scale=1)}}A.domCache=[];var P=A;class C{constructor(t){this.options=void 0,this.img=void 0,this.options=t;var i=t.style;if(i.type===a.img){var s=document.createElement("img");s.src=i,s.width=i.size,s.height=i.size,this.img=s}}draw(t,i){var s=this.options,e=s.borderWidth,r=s.borderColor,o=s.color,n=s.style,h=n.size/2,l=i.x,d=i.y,c=i.angle;if(t.translate(l,d),Object.assign(t,{lineWidth:e||0,strokeStyle:r||"#000",fillStyle:o||"#000"}),t.beginPath(),t.rotate(c+Math.PI),n.type===a.circle)t.arc(0,0,h,0,2*Math.PI,!1);else if(n.type===a.arrow)t.moveTo(h,h),t.lineTo(0,-h),t.lineTo(-h,h),t.lineTo(0,h/4),t.lineTo(h,h);else if(n.type===a.img&&this.img){var p=this.img,v=p.width,u=p.height;t.drawImage(this.img,-v/2,-u,v,u)}t.closePath(),t.stroke(),t.fill()}}var k=C;class O extends w{constructor(t){super(t),this.factor=void 0,this.deltaAngle=void 0,this.trailAngle=void 0,this.arcAngle=void 0,this.tailPointsCount=void 0,this.animateBlur=void 0,this.marker=void 0,this.tailPointsCount=10,this.factor=2/this.radius,this.deltaAngle=80/Math.min(this.radius,400)/this.tailPointsCount,this.trailAngle=this.startAngle,this.arcAngle=this.startAngle,Math.abs(this.startAngle-this.endAngle)>Math.PI&&(this.endAngle+=2*Math.PI),this.marker=new k({x:50,y:80,angle:50*Math.PI/180,style:t.marker,color:"rgb(255, 255, 255)",borderWidth:1,borderColor:this.color})}drawArc(t,i,s,e,a){Object.assign(t,{lineWidth:s,strokeStyle:i,shadowColor:i,lineCap:"round"}),t.beginPath(),t.arc(this.centerX,this.centerY,this.radius,e,a,!1),t.stroke()}draw(t,i){var s=this.endAngle,e=this.trailAngle,a=this.factor,r=this.color,o=this.deltaAngle,n=e+a,h=r;this.animateBlur&&(this.arcAngle=n),this.trailAngle=n,t.beginPath(),this.drawArc(t,h,2*this.lineWidth,this.startAngle,this.arcAngle);for(var l=this.tailPointsCount,d=0;d<l;d++){var c=r,p=5;e-o*d>this.startAngle&&this.drawArc(t,c,p-p/l*d,e-o*d,e)}t.stroke(),t.save(),t.translate(this.centerX,this.centerY),this.marker.draw(t,{x:Math.cos(this.trailAngle)*this.radius,y:Math.sin(this.trailAngle)*this.radius,angle:this.trailAngle}),t.restore(),!i&&180*(s-this.trailAngle)/Math.PI<.5&&(this.trailAngle=this.startAngle,this.animateBlur=!1)}}var j=O;class X{constructor(t){this.replace=void 0,this.onShow=void 0,this.onHide=void 0,this.el=void 0,this.context=void 0,this.el=o.a.DomUtil.create("div","",t.container),Object.assign(this.el.style,{position:"absolute",left:"0",top:"0",display:"none",zIndex:"11"}),this.context=o.a.DomUtil.create("div","",this.el);var i=t.options,s=i.replacePopover,e=i.onShowPopover,a=i.onHidePopover;"Function"===m(s)?this.replace=s:Object.assign(this.context.style,{border:"1px solid grey",background:"rgba(255,255,255,.3)",borderRadius:"5px",padding:"8px 16px"}),this.onShow=e,this.onHide=a}show(t,i,s,e){var a=s.value,r=s.labels,o=this.el,n=this.replace,h=this.onShow;if(n){var l=n(t,i,s,e);o.replaceChild(l,o.children[0])}else this.context.innerText="".concat(r[0]," -> ").concat(r[1],": ").concat(a);h&&"Function"===m(h)&&h(s,e),Object.assign(o.style,{display:"",transform:"translate(".concat(t+v,"px, ").concat(i+v,"px)")})}hide(t,i){var s=this.el,e=this.onHide;e&&"Function"===m(e)&&e(t,i),s.style.display="none"}}var Y=X;class E{constructor(t){var i=t.ctx;this.ctx=void 0,this.started=!1,this.playAnimation=!0,this.store={arcs:[],pulses:[],sparks:[]},this.popover=void 0,this.index=0,this.requestAnimationId=0,this.ctx=i,this.popover=new Y(i)}refresh(){var t=this.ctx,i=t.data,s=t.options,e=s.marker,a=Object(n["default"])(e.radius,2),r=a[0],o=a[1],h=e.textVisible,d=s.line,c=d.width,p=d.icon;if(i&&0!==i.length){this.clear();var v=g(i,(t=>t.value)),u=this.popover,m=l()(v,[r,o||2*r]),x=new Set;i.forEach(((t,i)=>{var s=t.from,e=t.to,a=t.labels,o=t.color,n=new b({startX:s[0],startY:s[1],endX:e[0],endY:e[1],labels:a,label:h,width:c,color:o}),l=m(t.value),d=s=>{var e=s.join("_");if(!x.has(e)){x.add(e);var a=new P({x:s[0],y:s[1],radius:l,index:i,data:t,popover:u,ctx:this.ctx});this.store.pulses.push(a)}};d(s),d(e);var v=new j({startX:s[0],startY:s[1],endX:e[0],endY:e[1],width:r,color:o,marker:p});this.store.arcs.push(n),this.store.sparks.push(v),this.index=0})),this.start()}}clear(){this.store.pulses.forEach((t=>t.clear())),this.store={arcs:[],pulses:[],sparks:[]},this.playAnimation=!0,this.started=!1,window.cancelAnimationFrame(this.requestAnimationId)}draw(t){var i=this.ctx.canvasCtx;t.forEach((t=>t.draw(i)));for(var s=0,e=t.length;s<e;s++)t[s].draw(i)}start(){var t=this.started,i=this.store,s=this.ctx,e=s.canvasCtx,a=s.canvas,r=a.width,o=a.height,n=s.options.line.order;if(!t){this.draw(i.pulses);var h=()=>{this.requestAnimationId=window.requestAnimationFrame(h),this.playAnimation&&e&&(e.clearRect(0,0,r,o),Object.keys(i).forEach((t=>{var s=i[t];if(n&&"sparks"===t){var a=s[this.index];a.draw(e,n),180*(a.endAngle-a.trailAngle)/Math.PI<.5&&(a.trailAngle=a.startAngle,this.index<s.length-1?this.index+=1:this.index=0)}else s.forEach((t=>t.draw(e)))})))};h(),this.started=!0}}play(){this.playAnimation=!0}pause(){this.playAnimation=!1}}var _=E,M=s("G3cz"),D=s("J9RX"),z=s("5Yrg"),L=s.n(z),I=["from","to"];class S{constructor(t){var i=t.container,s=t.canvas,e=t.data,a=t.options,r=t.map;this.options=p,this.data=[],this.map=void 0,this.container=void 0,this.canvas=void 0,this.canvasCtx=void 0,this.mapPosi=void 0,this.container=i,this.canvas=s,this.canvasCtx=s.getContext("2d"),this.map=r,this.data=this._convertData(e),this.setOptions(a),this.mapPosi=this.container.getBoundingClientRect(),window.addEventListener("scroll",(()=>{this.mapPosi=this.container.getBoundingClientRect()}))}setOptions(t){this.options=L()(this.options,t)}setData(t){this.data=this._convertData(t)}_convertData(t){var i=this.map;if(!i||!Array.isArray(t))return[];var s=i.getBounds();if(s){var e=t=>{var s=Object(n["default"])(t,2),e=s[0],a=s[1],r=i.latLngToContainerPoint(new o.a.LatLng(a,e)),h=r.x,l=r.y;return[h,l]};return t.map((t=>{var i=t.from,s=t.to,a=Object(D["a"])(t,I);return Object(M["a"])({from:e(i),to:e(s)},a)}))}return[]}}class T extends o.a.Layer{constructor(t,i){super(),this._show=!1,this.mapHandles=[],this.migration=void 0,this.options=void 0,this.data=void 0,this.ctx=void 0,this.data=t,this.options=i}onAdd(t){var i=t.getSize(),s=i.x,e=i.y,a=o.a.DomUtil.create("div","leaflet-ODLayer-container"),r=document.createElement("canvas");a.appendChild(r),Object.assign(this,{_show:!0});var n=this.data,h=this.options;return this.ctx=new S({container:a,canvas:r,data:n,options:h,map:t}),Object.assign(a.style,{position:"absolute",width:"".concat(s,"px"),height:"".concat(e,"px")}),t.getPanes().overlayPane.appendChild(a),this.ctx.map=t,this.migration=new _({ctx:this.ctx}),this._bindMapEvents(),this._draw(),this}onRemove(t){return this.mapHandles.forEach((i=>{var s=i.type,e=i.handle;return t.off(s,e)})),this.mapHandles=[],this.ctx&&o.a.DomUtil.remove(this.ctx.container),this.migration.clear(),this}setData(t){var i;return null===(i=this.ctx)||void 0===i||i.setData(t),this.migration.refresh(),this}setStyle(t){var i;return null===(i=this.ctx)||void 0===i||i.setOptions(t),this.migration.refresh(),this}setVisible(t){return this.ctx?(this.ctx.container.style.display=t?"":"none",this._show=t,this):this}hide(){return this.setVisible(!1)}show(){this.setVisible(!0)}play(){return this.migration.play(),this}pause(){return this.migration.pause(),this}_bindMapEvents(){var t=this.mapHandles,i=t=>{var i=t.target.getZoom();i<c?this.hide():(this._show||this.show(),this.migration.play(),this._draw())};if(this.ctx){var s=this.ctx,e=s.map,a=s.container;e.on("moveend",i),t.push({type:"moveend",handle:i});var r=()=>{a.style.display="none"};e.on("zoomstart ",r),t.push({type:"zoomstart",handle:r});var o=()=>{this._show&&(a.style.display="",this._draw())};e.on("zoomend",o),t.push({type:"zoomend",handle:o})}}_draw(){var t,i,s=null===(t=this.ctx)||void 0===t?void 0:t.map.getBounds();s&&this.migration.playAnimation&&(this._resize(),null===(i=this.ctx)||void 0===i||i.setData(this.data),this.migration.refresh())}_resize(){if(this.ctx){var t=this.ctx,i=t.map,s=t.canvas,e=t.container,a=i.getBounds(),r=a.getNorthWest(),n=i.latLngToContainerPoint(r),h=n.y;e.style.top=h>0?"".concat(-h,"px"):"0px";var l=window.getComputedStyle(i.getContainer());s.setAttribute("width",l.width),s.setAttribute("height",l.height);var d=i.latLngToLayerPoint(r);o.a.DomUtil.setPosition(e,d)}}}o.a.migrationLayer=function(t,i){return new T(t,i)}}}]);