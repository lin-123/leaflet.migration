(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6,7],{rrNk:function(t,e,i){"use strict";i.r(e),i.d(e,"MapContext",(function(){return h})),i.d(e,"useMapContext",(function(){return c})),i.d(e,"default",(function(){return l}));var s=i("iojd"),a=i("ahKI"),r=i.n(a),o=i("vrbx"),n=i.n(o),h=(i("sENK"),r.a.createContext({map:null})),c=()=>r.a.useContext(h);function l(t){var e=t.latitude,i=t.longitude,o=t.zoom,c=t.children,l=t.style,d=Object(a["useState"])(!1),v=Object(s["default"])(d,2),p=v[0],u=v[1],m=Object(a["useRef"])(),g=Object(a["useRef"])();return Object(a["useEffect"])((()=>{var t=n.a.map(m.current).setView([e,i],o);return n.a.tileLayer("http://webrd0{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}",{subdomains:["1","2","3","4"]}).addTo(t),g.current=t,u(!0),()=>{t.remove()}}),[]),r.a.createElement(h.Provider,{value:{map:g.current}},r.a.createElement("div",{ref:m,style:l},p&&c))}},suVT:function(t,e,i){"use strict";i.r(e),i.d(e,"Example",(function(){return G}));var s,a,r=i("mn0l"),o=i("G3cz"),n=i("iojd"),h=i("J9RX"),c=i("ahKI"),l=i.n(c),d=i("vrbx"),v=i.n(d),p=i("8jQa"),u=i.n(p);(function(t){t["circle"]="circle",t["arrow"]="arrow",t["img"]="img"})(s||(s={})),function(t){t["in"]="in",t["out"]="out"}(a||(a={}));var m=1.5,g=3,x={marker:{radius:[5,10],pulse:!0,textVisible:!1},line:{width:1,order:!0,icon:{type:s.circle,imgUrl:"",size:20},direction:a.out}},f=12;function b(t,e){var i=t=>t*t;return Math.sqrt(i(t)+i(e))}function w(t,e){var i=0,s=0;return t.forEach((t=>{var a=e(t);void 0===i?(s=a,i=a):(i>a&&(i=a),s<a&&(s=a))})),[i,s]}function y(t){return Object.prototype.toString.call(t).slice(8,-1)}class O{constructor(t){this.canvas=void 0,this.ctx=void 0,this.target=void 0,this.targetCtx=void 0,this.target=t,this.targetCtx=t.getContext("2d"),this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d");var e=this.target,i=e.width,s=e.height;Object.assign(this.canvas,{width:i,height:s})}clear(){var t,e=this.target,i=e.width,s=e.height;Object.assign(this.canvas,{width:i,height:s}),null===(t=this.ctx)||void 0===t||t.clearRect(0,0,i,s)}restore(){var t;null===(t=this.targetCtx)||void 0===t||t.drawImage(this.canvas,0,0)}}class j{constructor(t){this.startX=void 0,this.startY=void 0,this.endX=void 0,this.endY=void 0,this.centerX=void 0,this.centerY=void 0,this.startAngle=void 0,this.endAngle=void 0,this.radius=void 0,this.color=void 0,this.lineWidth=1,this.ctx=void 0;var e=t.from,i=t.to,s=t.width,a=t.color,r=void 0===a?"#fff":a,o=t.ctx,h=Object(n["default"])(e,2),c=h[0],l=h[1],d=Object(n["default"])(i,2),v=d[0],p=d[1];this.ctx=o;var u=b(c-v,l-p),g=(c+v)/2,x=(l+p)/2,f=(l-p)*m+g,w=(v-c)*m+x,y=b(u/2,u*m),O=Math.atan2(l-w,c-f),j=Math.atan2(p-w,v-f);this.startX=c,this.startY=l,this.endX=v,this.endY=p,this.centerX=f,this.centerY=w,this.startAngle=O,this.endAngle=j,this.radius=y,this.color=r,this.lineWidth=s||1}draw(t){}}var C=j;class A extends C{constructor(t){super(t),this.font=void 0,this.label=void 0,this.labels=void 0,this.font=t.font,this.label=t.label,this.labels=t.labels,this.draw(t.canvasCtx)}draw(t){if(t&&(Object.assign(t,{lineWidth:this.lineWidth,strokeStyle:this.color}),t.arc(this.centerX,this.centerY,this.radius,this.startAngle,this.endAngle,!1),this.label)){var e=Object(n["default"])(this.labels,2),i=e[0],s=e[1];if(Object.assign(t,{font:this.font}),i){var a=this.startX-15,r=this.startY+5;t.fillText(i,a,r)}if(s){var o=this.endX-15,h=this.endY-5;t.fillText(s,o,h)}}}}var k=A,P=[];class E{constructor(t){this.options=void 0,this.scale=1,this.pulse=void 0,this.ring=void 0,this.showPopover=t=>{var e=t.clientX,i=t.clientY,s=this.options,a=s.data,r=s.index,o=s.popover,n=s.ctx,h=n.mapPosi,c=h.top,l=h.left;o.show(e-l,i-c,a,r)},this.hidePopover=()=>{var t=this.options,e=t.data,i=t.index,s=t.popover;s.hide(e,i)},this.options=t,this.initDom()}clear(){var t=this.pulse;P.push(t),t.removeEventListener("mouseover",this.showPopover),t.removeEventListener("mouseout",this.hidePopover),this.options.ctx.container.removeChild(t)}initDom(){P.length>0?(this.pulse=P.pop(),this.ring=this.pulse.children[0]):(this.pulse=document.createElement("div"),this.ring=document.createElement("div"),this.pulse.appendChild(this.ring));var t=this.options,e=t.x,i=t.y,s=t.radius,a=t.data.color,r=this.pulse,o=this.ring;Object.assign(r.style,{position:"absolute",zIndex:"1",borderRadius:"50%",width:"".concat(2*s,"px"),height:"".concat(2*s,"px"),left:"-".concat(s,"px"),top:"-".concat(s,"px"),background:a,transform:"translate(".concat(e,"px, ").concat(i,"px)")}),Object.assign(o.style,{position:"absolute",borderRadius:"50%",width:"".concat(2*s,"px"),height:"".concat(2*s,"px"),left:"".concat(-1,"px"),top:"".concat(-1,"px"),border:"1px solid ".concat(a)}),o.animate([{transform:"scale(1)"},{transform:"scale(2)"}],{duration:1e3,iterations:1/0}),this.options.ctx.container.appendChild(r),r.addEventListener("mouseover",this.showPopover),r.addEventListener("mouseout",this.hidePopover)}draw(){}}E.domCache=[];var M=E;class S{constructor(t){this.options=void 0,this.img=void 0,this.options=t;var e=t.style;if(e.type===s.img){var i=document.createElement("img");i.src=e,i.width=e.size,i.height=e.size,this.img=i}}draw(t,e){var i=this.options,a=i.borderWidth,r=i.borderColor,o=i.color,n=i.style,h=n.size/2,c=e.x,l=e.y,d=e.angle;if(t.translate(c,l),Object.assign(t,{lineWidth:a||0,strokeStyle:r||"#000",fillStyle:o||"#000"}),t.beginPath(),t.rotate(d+Math.PI),n.type===s.circle)t.arc(0,0,h,0,2*Math.PI,!1);else if(n.type===s.arrow)t.moveTo(h,h),t.lineTo(0,-h),t.lineTo(-h,h),t.lineTo(0,h/4),t.lineTo(h,h);else if(n.type===s.img&&this.img){var v=this.img,p=v.width,u=v.height;t.drawImage(this.img,-p/2,-u,p,u)}t.closePath(),t.stroke(),t.fill()}}var L=S;class z extends C{constructor(t){super(t),this.factor=void 0,this.deltaAngle=void 0,this.trailAngle=void 0,this.tailPointsCount=void 0,this.animateBlur=void 0,this.marker=void 0,this.tailPointsCount=10,this.factor=2/this.radius,this.deltaAngle=80/Math.min(this.radius,400)/this.tailPointsCount,this.trailAngle=this.startAngle,Math.abs(this.startAngle-this.endAngle)>Math.PI&&(this.endAngle+=2*Math.PI),this.marker=new L({style:t.marker,color:"rgb(255, 255, 255)",borderWidth:1,borderColor:this.color})}drawArc(t,e,i,s,a){Object.assign(t,{lineWidth:i,strokeStyle:e,shadowColor:e,lineCap:"round"}),t.beginPath(),t.arc(this.centerX,this.centerY,this.radius,s,a,!1),t.closePath(),t.stroke()}draw(t,e){this.endAngle;var i=this.trailAngle,s=this.factor,a=this.color,r=i+s;this.trailAngle=r;var o=5;this.drawArc(t,a,o,i,i),this.isEnd&&!e&&this.restart()}drawMarker(t){t.save(),t.translate(this.centerX,this.centerY),this.marker.draw(t,{x:Math.cos(this.trailAngle)*this.radius,y:Math.sin(this.trailAngle)*this.radius,angle:this.trailAngle}),t.restore()}get isEnd(){return 180*(this.endAngle-this.trailAngle)/Math.PI<.5}restart(){this.trailAngle=this.startAngle}}var _=z;class D{constructor(t){this.replace=void 0,this.onShow=void 0,this.onHide=void 0,this.el=void 0,this.context=void 0,this.el=v.a.DomUtil.create("div","",t.container),Object.assign(this.el.style,{position:"absolute",left:"0",top:"0",display:"none",zIndex:"11"}),this.context=v.a.DomUtil.create("div","",this.el);var e=t.options,i=e.replacePopover,s=e.onShowPopover,a=e.onHidePopover;"Function"===y(i)?this.replace=i:Object.assign(this.context.style,{border:"1px solid grey",background:"rgba(255,255,255,.3)",borderRadius:"5px",padding:"8px 16px"}),this.onShow=s,this.onHide=a}show(t,e,i,s){var a=i.value,r=i.labels,o=this.el,n=this.replace,h=this.onShow;if(n){var c=n(t,e,i,s);"string"===typeof c?this.context.innerText=c:o.replaceChild(c,o.children[0])}else this.context.innerText="".concat(r[0]," -> ").concat(r[1],": ").concat(a);h&&"Function"===y(h)&&h(i,s),Object.assign(o.style,{display:"",transform:"translate(".concat(t+f,"px, ").concat(e+f,"px)")})}hide(t,e){var i=this.el,s=this.onHide;s&&"Function"===y(s)&&s(t,e),i.style.display="none"}}var I=D;class R{constructor(t){var e=t.ctx;this.ctx=void 0,this.started=!1,this.playAnimation=!0,this.store={arcs:[],pulses:[],sparks:[]},this.popover=void 0,this.index=0,this.requestAnimationId=0,this.lineCache=void 0,this.sparkCache=void 0,this.ctx=e,this.popover=new I(e),this.lineCache=new O(e.canvas),this.sparkCache=new O(e.canvas)}refresh(){var t=this.ctx,e=t.data,i=t.options,s=Object(n["default"])(i.marker.radius,2),a=s[0],r=s[1],o=i.line.icon;if(e&&0!==e.length){this.clear();var h=w(e,(t=>t.value)),c=this.popover,l=u()(h,[a,r||2*a]),d=new Set;this.drawLines(),e.forEach(((t,e)=>{var i=t.from,s=t.to,r=t.color,n=l(t.value),h=i=>{var s=i.join("_");if(!d.has(s)){d.add(s);var a=new M({x:i[0],y:i[1],radius:n,index:e,data:t,popover:c,ctx:this.ctx});this.store.pulses.push(a)}};h(i),h(s);var v=new _({from:i,to:s,width:a,color:r,marker:o,ctx:this.ctx});this.store.sparks.push(v)})),this.index=0,this.start()}}clear(){this.store.pulses.forEach((t=>t.clear())),this.store={arcs:[],pulses:[],sparks:[]},this.playAnimation=!0,this.started=!1,window.cancelAnimationFrame(this.requestAnimationId)}draw(t){var e=this.ctx.canvasCtx;t.forEach((t=>t.draw(e)));for(var i=0,s=t.length;i<s;i++)t[i].draw(e)}drawLines(){var t=this.ctx,e=t.data,i=t.options,s=i.marker.textVisible,a=i.line.width,r=this.lineCache.ctx;this.lineCache.clear(),this.sparkCache.clear(),e.map((t=>{null===r||void 0===r||r.beginPath();var e=t.from,i=t.to,o=t.labels,n=t.color;new k({from:e,to:i,labels:o,label:s,width:a,color:n,canvasCtx:r}),null===r||void 0===r||r.stroke()})),this.lineCache.restore()}restoreLines(){this.lineCache.restore()}drawSpark(){var t=this.ctx.options.line.order,e=this.sparkCache.ctx;if(e){e.save(),e.fillStyle="rgba(0, 0, 0, 0.9)",e.globalCompositeOperation="destination-in";var i=this.ctx.canvas,s=i.width,a=i.height;e.fillRect(0,0,s,a),e.restore();var r=this.store.sparks;if(t){var o=r[this.index];o.draw(e,t),o.isEnd&&(o.restart(),this.index<r.length-1?this.index+=1:this.index=0)}else r.forEach((t=>t.draw(e)));this.sparkCache.restore()}}drawSparkMarkers(){this.store.sparks.forEach((t=>{t.drawMarker(this.ctx.canvasCtx)}))}start(){var t=this.started,e=this.store,i=this.ctx,s=i.canvasCtx,a=(i.options.line.order,i.canvas),r=a.width,o=a.height;if(!t){this.draw(e.pulses);var n=()=>{this.requestAnimationId=window.requestAnimationFrame(n),this.playAnimation&&s&&(s.clearRect(0,0,r,o),this.restoreLines(),this.drawSpark(),this.drawSparkMarkers())};n(),this.started=!0}}play(){this.playAnimation=!0}pause(){this.playAnimation=!1}}var T=R,X=i("5Yrg"),Y=i.n(X),H=["from","to"];class W{constructor(t){var e=t.container,i=t.canvas,s=t.data,a=t.options,r=t.map;this.options=x,this.data=[],this.map=void 0,this.container=void 0,this.canvas=void 0,this.canvasCtx=void 0,this.mapPosi=void 0,this.container=e,this.canvas=i,this.canvasCtx=i.getContext("2d"),this.map=r,this.data=this._convertData(s),this.setOptions(a),this.mapPosi=this.container.getBoundingClientRect(),window.addEventListener("scroll",(()=>{this.mapPosi=this.container.getBoundingClientRect()}))}setOptions(t){this.options=Y()(this.options,t)}setData(t){this.data=this._convertData(t)}_convertData(t){var e=this.map;if(!e||!Array.isArray(t))return[];var i=e.getBounds();if(i){var s=t=>{var i=Object(n["default"])(t,2),s=i[0],a=i[1],r=e.latLngToContainerPoint(new v.a.LatLng(a,s)),o=r.x,h=r.y;return[o,h]};return t.map((t=>{var e=t.from,i=t.to,a=Object(h["a"])(t,H);return Object(o["a"])({from:s(e),to:s(i)},a)}))}return[]}}class V extends v.a.Layer{constructor(t,e){super(),this._show=!1,this.mapHandles=[],this.migration=void 0,this.options=void 0,this.data=void 0,this.ctx=void 0,this.data=t,this.options=e}onAdd(t){var e=t.getSize(),i=e.x,s=e.y,a=v.a.DomUtil.create("div","leaflet-ODLayer-container"),r=document.createElement("canvas");a.appendChild(r),Object.assign(this,{_show:!0}),Object.assign(a.style,{position:"absolute",width:"".concat(i,"px"),height:"".concat(s,"px")}),t.getPanes().overlayPane.appendChild(a);var o=this.data,n=this.options;return this.ctx=new W({container:a,canvas:r,data:o,options:n,map:t}),this.ctx.map=t,this.migration=new T({ctx:this.ctx}),this._bindMapEvents(),this._draw(),this}onRemove(t){return this.mapHandles.forEach((e=>{var i=e.type,s=e.handle;return t.off(i,s)})),this.mapHandles=[],this.ctx&&v.a.DomUtil.remove(this.ctx.container),this.migration.clear(),this}setData(t){var e;return null===(e=this.ctx)||void 0===e||e.setData(t),this.migration.refresh(),this}setStyle(t){var e;return null===(e=this.ctx)||void 0===e||e.setOptions(t),this.migration.refresh(),this}setVisible(t){return this.ctx?(this.ctx.container.style.display=t?"":"none",this._show=t,this):this}hide(){return this.setVisible(!1)}show(){this.setVisible(!0)}play(){return this.migration.play(),this}pause(){return this.migration.pause(),this}_bindMapEvents(){var t=this.mapHandles,e=t=>{var e=t.target.getZoom();e<g?this.hide():(this._show||this.show(),this.migration.play(),this._draw())};if(this.ctx){var i=this.ctx,s=i.map,a=i.container;s.on("moveend",e),t.push({type:"moveend",handle:e});var r=()=>{a.style.display="none"};s.on("zoomstart ",r),t.push({type:"zoomstart",handle:r});var o=()=>{this._show&&(a.style.display="",this._draw())};s.on("zoomend",o),t.push({type:"zoomend",handle:o})}}_draw(){var t,e,i=null===(t=this.ctx)||void 0===t?void 0:t.map.getBounds();i&&this.migration.playAnimation&&(this._resize(),null===(e=this.ctx)||void 0===e||e.setData(this.data),this.migration.refresh())}_resize(){if(this.ctx){var t=this.ctx,e=t.map,i=t.canvas,s=t.container,a=e.getBounds(),r=a.getNorthWest(),o=e.latLngToContainerPoint(r),n=o.y;s.style.top=n>0?"".concat(-n,"px"):"0px";var h=window.getComputedStyle(e.getContainer());i.setAttribute("width",h.width),i.setAttribute("height",h.height);var c=e.latLngToLayerPoint(r);v.a.DomUtil.setPosition(s,c)}}}v.a.migrationLayer=function(t,e){return new V(t,e)};var U=i("rrNk"),B=Object(c["forwardRef"])(((t,e)=>{var i=t.visible,s=void 0===i||i,a=t.data,r=t.options,n=t.replacePopover,h=t.onShowPopover,l=t.onHidePopover,d=Object(U["useMapContext"])(),p=d.map,u=Object(c["useRef"])(null),m=()=>Object(o["a"])(Object(o["a"])({},r),{},{replacePopover:n,onShowPopover:h,onHidePopover:l});return Object(c["useImperativeHandle"])(e,(()=>({target:u.current}))),Object(c["useEffect"])((()=>{if(p){u.current=v.a.migrationLayer(a,m()),console.log(p);var t=p.addLayer(u.current);return()=>{p.removeLayer(t)}}}),[]),Object(c["useEffect"])((()=>{var t;null===(t=u.current)||void 0===t||t.setData(a)}),[a]),Object(c["useEffect"])((()=>{var t;null===(t=u.current)||void 0===t||t.setStyle(m())}),[r]),Object(c["useEffect"])((()=>{u.current[s?"show":"hide"]()}),[s]),null})),q=B,F=(t,e)=>Math.floor(t+(e-t)*Math.random()),N=(t,e)=>Array.from({length:t},((t,i)=>e({color:"rgb(101, 169, 249)",from:[F(84,116),F(32,48)],to:[F(84,116),F(32,48)],labels:["from-".concat(i),"to-".concat(i)],value:F(1,10)}))),J=t=>N(t,(t=>Object(o["a"])(Object(o["a"])({},t),{},{from:[96.404844,40],labels:["somewhere",t.labels[1]]}))),K=(J(10),N(10,(t=>Object(o["a"])(Object(o["a"])({},t),{},{color:"rgba(251,176,49,0.8)",to:[116.404844,39.91405],labels:[t.labels[0],"\u5317\u4eac"]}))),["dataLen","visible"]),G=Object(c["forwardRef"])(((t,e)=>{var i=t.dataLen,s=void 0===i?10:i,a=t.visible,d=Object(h["a"])(t,K),v=Object(c["useState"])(J(s)),p=Object(n["default"])(v,2),u=p[0],m=p[1],g=Object(c["useState"])({marker:{radius:[5,10],pulse:!0,textVisible:!0},line:{width:1,order:!1,icon:{type:"circle",imgUrl:"",size:10}}}),x=Object(n["default"])(g,2),f=x[0],b=x[1],w=()=>{f.marker.radius[1]=20*Math.random(),f.line.width=5*Math.random(),b(Object(o["a"])({},f))},y=()=>m(J(s));return Object(c["useImperativeHandle"])(e,(()=>({updateStyle:w,updateData:y}))),l.a.createElement(q,Object(r["a"])({visible:a,data:u,options:f},d))}))}}]);